@inherits LayoutComponentBase
@using Microsoft.AspNetCore.Hosting
@using PrestamoBlazorApp.Shared.Components.Forms
@using PrestamoBlazorApp.Shared.MudUtils;


<AuthorizedUser />
<GeneralOverload SetOverLoad="SetOverLoad"></GeneralOverload>
<MudThemeProvider Theme="_currentTheme" />
<MudDialogProvider />
<MudSnackbarProvider />
<AuthorizeView>
    <MudLayout>
        <MudAppBar>
            <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="MudBlazor.Color.Inherit" Edge="Edge.Start" OnClick="@((e) => DrawerToggle())" />
            @Texto
        </MudAppBar>
        <MudDrawer @bind-Open="@DrawerOpen">
            <MudSwitch T="bool" @bind-value="@AuthMenu" Color="MudBlazor.Color.Success" Label="Activar Autorizacion" />
            @if (AuthMenu)
            {
                <NavMenuAuth />
            }
            else
            {
                @if (IsDevelopment)
                {
                    <NavMenuNoAuth />
                }
                else
                {
                    <NavMenuAuth />
                }
            }

        </MudDrawer>

        <MudMainContent>
            @Body

        </MudMainContent>
    </MudLayout>

</AuthorizeView>

@code {
    [Inject] IWebHostEnvironment env { get; set; }
    public static bool SetOverLoad { get; set; } = false;
    bool DrawerOpen = true;

    string Texto => DrawerOpen ? "Ocultar Menu" : "Mostrar Menu";
    void DrawerToggle()
    {
        DrawerOpen = !DrawerOpen;
    }
    private MudTheme _currentTheme = new MudBlazorAdminDashboard();
    private bool AuthMenu { get; set; } = true;

    private bool IsDevelopment => env.EnvironmentName == "Development";
}

